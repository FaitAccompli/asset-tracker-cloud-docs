digraph G {
    rankdir=LR
    node [ shape=none fontname=sans ]
    edge [ fontname=sans ]
    checkDeviceMode [ label="Check\ndevice mode" shape=diamond ]
    waitForMovement  [ label="Sleep and\nwait for\nmovement" shape=circle ]
    searchGPS [ label="Search for\nGPS fix" shape=circle ]
    checkCellular [ label="Check current\ncellular network\nregistration\nstatus" shape=circle ]
    publish [ label="Publish data" shape=circle ]
    sleepActive [ label="Sleep until\nwait time" shape=circle ]
    checkDeviceMode:n -> waitForMovement [ label="Passive" ]
    checkDeviceMode:e -> sleepActive [ label="Active" ]
    waitForMovement -> searchGPS
    sleepActive -> searchGPS
    searchGPS -> checkCellular -> publish
    publish -> checkDeviceMode:s
}